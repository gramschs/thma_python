---
kernelspec:
  name: python3
  display_name: 'Python 3'
---

# 5.2 for-Schleifen und Plotly Express

Im letzten Kapitel haben wir Ergebnisse von Berechnungen als Tabelle auf dem
Bildschirm ausgegeben. In diesem Kapitel kombinieren wir for-Schleifen mit
Plotly Express, um Daten zu visualisieren. Dazu verwenden wir ein typisches
Muster: Wir initialisieren leere Listen, füllen sie in der Schleife mit
berechneten Werten und übergeben sie anschließend an Plotly Express.

## Lernziele

```{admonition} Lernziele
:class: attention
* [ ] Sie können mit einer for-Schleife Listen mit Berechnungsergebnissen
  füllen und diese mit Plotly Express visualisieren.
* [ ] Sie können mit `px.bar()`  **Balkendiagramme** erstellen.
```

## Liniendiagramm mit for-Schleife

Im vorherigen Kapitel haben wir den Bremsweg für verschiedene Geschwindigkeiten
als Tabelle ausgegeben. Jetzt visualisieren wir dieselben Daten als
Liniendiagramm. Dazu erzeugen wir zunächst mit einer for-Schleife zwei Listen,
eine für die Geschwindigkeiten und eine für die zugehörigen Bremswege. Beide
Listen übergeben wir an Plotly Express.

```{code-cell} python
import plotly.express as px

geschwindigkeiten = []
bremswege = []

for v in range(0, 131, 10):
    geschwindigkeiten.append(v)
    bremswege.append(v**2 / 100)

fig = px.line(x=geschwindigkeiten, y=bremswege,
              labels={"x": "Geschwindigkeit (km/h)",
                      "y": "Bremsweg (m)"},
              title="Bremsweg in Abhängigkeit der Geschwindigkeit")
fig.show()
```

Das Muster, das wir hier verwenden, ist typisch für die Kombination von
for-Schleife und Plotly Express: Wir initialisieren leere Listen, füllen sie in
der Schleife mit berechneten Werten und übergeben sie anschließend an die
Visualisierungsfunktion.

```{admonition} Mini-Übung
:class: tip
Erstellen Sie analog zum Bremsweg-Beispiel ein Liniendiagramm für den
Anhalteweg in Abhängigkeit der Geschwindigkeit. Der Anhalteweg ergibt sich als
Summe aus Reaktionsweg und Bremsweg:

$$s_{gesamt} = \frac{v}{3.6} + \frac{v^2}{100}$$

Verwenden Sie denselben Geschwindigkeitsbereich von 0 km/h bis 130 km/h.
```

```{code-cell} python
# Code-Zelle
```

````{admonition} Lösung
:class: tip
:class: dropdown
```python
import plotly.express as px

geschwindigkeiten = []
anhaltewege = []

for v in range(0, 131, 10):
    geschwindigkeiten.append(v)
    anhaltewege.append(v / 3.6 + v**2 / 100)

fig = px.line(x=geschwindigkeiten, y=anhaltewege,
              labels={"x": "Geschwindigkeit (km/h)",
                      "y": "Anhalteweg (m)"},
              title="Anhalteweg in Abhängigkeit der Geschwindigkeit")
fig.show()
```
````

## Balkendiagramm mit px.bar()

Bisher haben wir `px.line()` verwendet, um kontinuierliche Verläufe
darzustellen. Für kategoriale Daten (= Daten, die zu bestimmten Kategorien
gehören und nicht auf einer kontinuierlichen Skala liegen) eignet sich ein
Balkendiagramm besser. In Plotly Express erstellen wir Balkendiagramme mit
`px.bar()`.

Als Beispiel greifen wir das Wahlergebnis aus dem letzten Kapitel auf. Dort
haben wir die Stimmen für Anna, Bob und ungültige Stimmen gezählt:

```{code-cell} python
anzahl_anna = 0
anzahl_bob = 0
anzahl_gesamt = 0

for zettel in ["Bob", "Anna", "Anna", "Charlie", "Anna", "Bob", "Anna"]:
    anzahl_gesamt = anzahl_gesamt + 1
    if zettel == "Anna":
        anzahl_anna = anzahl_anna + 1
    if zettel == "Bob":
        anzahl_bob = anzahl_bob + 1

anzahl_ungueltig = anzahl_gesamt - anzahl_anna - anzahl_bob
```

Diese Ergebnisse visualisieren wir jetzt als Balkendiagramm:

```{code-cell} python
fig = px.bar(x=['Anna', 'Bob', 'ungültig'],
             y=[anzahl_anna, anzahl_bob, anzahl_ungueltig],
             labels={'x': 'Kandidat', 'y': 'Anzahl Stimmen'},
             title='Ergebnis der Vereinswahl')
fig.show()
```

Die Syntax von `px.bar()` ist dieselbe wie bei `px.line()`: Wir übergeben die
Kategorien als Liste an `x` und die zugehörigen Werte als Liste an `y`.

```{admonition} Mini-Übung
:class: tip
Bei der nächsten Vereinswahl treten drei Kandidaten an: Anna, Bob und Clara.
Die Wahlzettel lauten:

`["Bob", "Anna", "Clara", "Anna", "Bob", "Clara", "Clara", "Anna", "Bob", "Clara"]`

Zählen Sie die Stimmen für alle drei Kandidaten und stellen Sie das Ergebnis
als Balkendiagramm dar.
```

```{code-cell} python
# Code-Zelle
```

````{admonition} Lösung
:class: tip
:class: dropdown
```python
import plotly.express as px

anzahl_anna = 0
anzahl_bob = 0
anzahl_clara = 0

for zettel in ["Bob", "Anna", "Clara", "Anna", "Bob",
               "Clara", "Clara", "Anna", "Bob", "Clara"]:
    if zettel == "Anna":
        anzahl_anna = anzahl_anna + 1
    if zettel == "Bob":
        anzahl_bob = anzahl_bob + 1
    if zettel == "Clara":
        anzahl_clara = anzahl_clara + 1

fig = px.bar(x=["Anna", "Bob", "Clara"],
             y=[anzahl_anna, anzahl_bob, anzahl_clara],
             labels={"x": "Kandidat", "y": "Anzahl Stimmen"},
             title="Ergebnis der Vereinswahl")
fig.show()
```
````

## Zusammenfassung und Ausblick

In diesem Kapitel haben wir gelernt, wie man for-Schleifen mit Plotly Express
kombiniert. Wir haben das typische Muster kennengelernt, bei dem leere Listen
initialisiert, in der Schleife mit Werten gefüllt und anschließend an Plotly
Express übergeben werden. Mit `px.bar()` haben wir einen neuen Diagrammtyp für
kategoriale Daten kennengelernt. Im nächsten Kapitel werden wir das Thema
Strings erneut aufgreifen und vertiefen.
